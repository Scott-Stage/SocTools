function Process-AtomSvcFile {
  param (
    [Parameter(Mandatory = $true, Position = 0)]
    [string]$FilePath
  )

  try {
    # Read the XML content from the file
    [xml]$xmlContent = Get-Content -Path $FilePath -Encoding UTF8

    # Navigate to the link with the rel="service.metadata" attribute
    $metadataLink = $xmlContent.feed.link | Where-Object { $_.rel -eq "service.metadata" }

    # Check if the link was found
    if ($metadataLink) {
      $metadataUrl = $metadataLink.href
      Write-Host "Metadata URL: $metadataUrl"
      return $metadataUrl
    } else {
      Write-Warning "No metadata link found in $($FilePath)."
      return $null
    }
  }
  catch {
    Write-Error "Error processing $($FilePath): $($_.Exception.Message)"
    return $null
  }
}

# Example usage:  Replace "C:\Path\To\Your\Service.atomsvc" with your file path.
$atomsvcFilePath = "C:\Path\To\Your\Service.atomsvc"
$metadataUrl = Process-AtomSvcFile -FilePath $atomsvcFilePath

if ($metadataUrl) {
  # Do something with the metadata URL.  For example:
  # Invoke-WebRequest -Uri $metadataUrl -OutFile "C:\temp\metadata.xml"
  Write-Host "Metadata URL saved to C:\temp\metadata.xml"
}