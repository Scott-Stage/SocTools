var entry = TryParseAclEntry(tokens, lineNumber, trimmed, currentAclName, inNamedAcl);
            if (entry is null)
            {
                if (LooksLikeAclLine(tokens))
                {
                    ParseWarnings.Add($"Line {lineNumber}: Unrecognized ACL syntax.");
                }
                continue;
            }

            if (TryAttachRemark(entry, results))
            {
                continue;
            }

            results.Add(entry with { Occurrence = results.Count + 1 });
        }

        return results;
    }

    private static bool TryAttachRemark(AclEntry remarkEntry, List<AclEntry> results)
    {
        if (!remarkEntry.Action.Equals("remark", StringComparison.OrdinalIgnoreCase))
        {
            return false;
        }

        if (results.Count == 0 || string.IsNullOrWhiteSpace(remarkEntry.Remark))
        {
            return false;
        }

        for (var i = results.Count - 1; i >= 0; i--)
        {
            var candidate = results[i];
            if (!string.IsNullOrWhiteSpace(remarkEntry.AclName) &&
                !candidate.AclName.Equals(remarkEntry.AclName, StringComparison.OrdinalIgnoreCase))
            {
                continue;
            }

            if (candidate.Action.Equals("remark", StringComparison.OrdinalIgnoreCase))
            {
                continue;
            }

            var newRemark = string.IsNullOrWhiteSpace(candidate.Remark)
                ? remarkEntry.Remark
                : $"{candidate.Remark} / {remarkEntry.Remark}";
            results[i] = candidate with { Remark = newRemark };
            return true;
        }

        return false;
    }