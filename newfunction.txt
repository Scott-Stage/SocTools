Import-Module ActiveDirectory

$GUID_ENROLL     = [guid]'0e10c968-78fb-11d2-90d4-00c04f79dc55'
$GUID_AUTOENROLL = [guid]'a05b8cc2-17bc-4802-a710-e7c15ab866a2'

$cfg  = (Get-ADRootDSE).configurationNamingContext
$base = "CN=Certificate Templates,CN=Public Key Services,CN=Services,$cfg"

$templates = Get-ADObject -SearchBase $base -LDAPFilter '(objectClass=pKICertificateTemplate)' `
                          -Properties cn,displayName

$result = foreach ($t in $templates) {
  $acl = Get-Acl -Path ("AD:\" + $t.DistinguishedName)
  $acl.Access | Where-Object {
      $_.AccessControlType -eq 'Allow' -and
      $_.ActiveDirectoryRights.HasFlag([System.DirectoryServices.ActiveDirectoryRights]::ExtendedRight) -and
      ($_.ObjectType -eq $GUID_ENROLL -or $_.ObjectType -eq $GUID_AUTOENROLL)
  } | Select-Object @{n='TemplateCN';e={$t.cn}},
                    @{n='TemplateDisplayName';e={$t.displayName}},
                    @{n='Right';e={ if ($_.ObjectType -eq $GUID_ENROLL){'Enroll'} else {'Autoenroll'} }},
                    @{n='Principal';e={$_.IdentityReference.Value}},
                    @{n='IsInherited';e={$_.IsInherited}}
}

$result | Sort-Object TemplateCN,Right,Principal | Format-Table -AutoSize
# Export if you like:
# $result | Export-Csv .\Template-Enrollers.csv -NoTypeInformation
