function Convert-XmlToJson {
    param (
        [xml]$XmlInput
    )

    $JsonObject = [ordered] @{}

    # Get the root element
    $rootElement = $XmlInput.DocumentElement

    # Get the root element's attributes
    foreach ($attribute in $rootElement.Attributes) {
        $JsonObject[$attribute.Name] = $attribute.Value
    }

    # Process the 'data' element (if it exists)
    $dataElement = $rootElement.SelectSingleNode("data") # More robustly find the data element

    if ($dataElement) {
        # Loop through the 'item' elements within the 'data' element
        foreach ($itemNode in $dataElement.SelectNodes("item")) {
            $itemName = $itemNode.GetAttribute("name")
            $item = [ordered] @{
                "id" = $itemNode.GetAttribute("id")
                "value" = $itemNode.GetAttribute("value")
            }
            $JsonObject[$itemName] = $item
        }
    }

    return ConvertTo-Json -InputObject $JsonObject -Depth 10
}

# Example usage
$xmlFilePath = "C:\Users\Scott\Desktop\test.xml"  # Replace with your XML file path

try {
    $xmlContent = Get-Content -Path $xmlFilePath -Raw
    $xmlData = [xml]$xmlContent

    $jsonOutput = Convert-XmlToJson -XmlInput $xmlData

    Write-Host $jsonOutput
}
catch {
    Write-Error "Error processing XML: $($_.Exception.Message)"
}