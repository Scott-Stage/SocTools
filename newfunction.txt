function Convert-XmlToJson {
    param (
        [xml]$XmlInput
    )

    $JsonObject = [ordered] @{}

    # Get the root element
    $rootElement = $XmlInput.DocumentElement

    # Iterate through the child nodes of the root element
    foreach ($childNode in $rootElement.ChildNodes) {
        if ($childNode.NodeType -eq "Element") {
            # Check if the child node has attributes
            if ($childNode.HasAttributes) {
                $childName = $childNode.Name
                $item = [ordered] @{}
                #Get every attribute
                foreach ($attribute in $childNode.Attributes) {
                    $item[$attribute.Name] = $attribute.Value
                }

                $JsonObject[$childName] = $item #Add to the JsonObject

            }
             else{
                #Handle empty elements

                 $childName = $childNode.Name
                 $JsonObject[$childName]= "" #set to empty

             }


        }
    }

    return ConvertTo-Json -InputObject $JsonObject -Depth 10
}


# Example usage:
$xmlFilePath = "C:\Users\Scott\Desktop\test.xml" # Replace with your XML file path

try {
    $xmlContent = Get-Content -Path $xmlFilePath -Raw
    $xmlData = [xml]$xmlContent

    $jsonOutput = Convert-XmlToJson -XmlInput $xmlData

    Write-Host $jsonOutput
}
catch {
    Write-Error "Error processing XML: $($_.Exception.Message)"
}