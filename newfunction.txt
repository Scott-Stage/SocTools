function Process-AtomSvcFile {
  param (
    [Parameter(Mandatory = $true, Position = 0)]
    [string]$FilePath
  )

  try {
    # Read the XML content from the file
    [xml]$xmlContent = Get-Content -Path $FilePath -Encoding UTF8

    # Navigate to the workspace element
    $workspace = $xmlContent.feed.workspace

    if ($workspace) {
        # Navigate to the collection element
        $collection = $workspace.collection

        if ($collection) {
          #Extract the href attribute
          $collectionHref = $collection.href

          if ($collectionHref) {
            Write-Host "Collection URL: $collectionHref"
            return $collectionHref
          }
          else {
            Write-Warning "No 'href' attribute found in the collection element of $($FilePath)."
            return $null
          }
        }
        else {
          Write-Warning "No collection element found in the workspace of $($FilePath)."
          return $null
        }
    }
    else{
      Write-Warning "No workspace element found in $($FilePath)."
      return $null
    }
  }
  catch {
    Write-Error "Error processing $($FilePath): $($_.Exception.Message)"
    return $null
  }
}

# Example usage:  Replace "C:\Path\To\Your\Service.atomsvc" with your file path.
$atomsvcFilePath = "C:\Path\To\Your\Service.atomsvc"
$collectionUrl = Process-AtomSvcFile -FilePath $atomsvcFilePath

if ($collectionUrl) {
  # Do something with the collection URL.  For example:
  # Invoke-WebRequest -Uri $collectionUrl
  Write-Host "Collection URL retrieved successfully."
}