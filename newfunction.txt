function Get-WCFMetadataUrl {
    param(
        [string]$AtomSvcUrl
    )

    try {
        $webClient = New-Object System.Net.WebClient
        $xml = [xml]$webClient.DownloadString($AtomSvcUrl)

        $metadataLink = $xml.feed.link | Where-Object {$_.rel -eq 'service.metadata'}

        if ($metadataLink) {
            return $metadataLink.href
        } else {
            Write-Warning "Could not find service metadata URL in '$AtomSvcUrl'."
            return $null
        }
    }
    catch {
        Write-Error "Error retrieving or processing '$AtomSvcUrl': $_"
        return $null
    }
}

# Example usage:
$atomsvcUrl = "http://yourserver/yourservice.atomsvc" # Replace with your URL
$metadataUrl = Get-WCFMetadataUrl -AtomSvcUrl $atomsvcUrl

if ($metadataUrl) {
    Write-Host "Metadata URL: $metadataUrl"
    # Use $metadataUrl to generate client proxy or inspect service details
    # Example using svcutil:
    # & svcutil.exe $metadataUrl
}