function Process-AtomSvcFile {
  param (
    [Parameter(Mandatory = $true, Position = 0)]
    [string]$FilePath
  )

  try {
    # Read the XML content from the file
    [xml]$xmlContent = Get-Content -Path $FilePath -Encoding UTF8

    # Navigate to the collection element and extract the href attribute
    $collectionHref = $xmlContent.feed.workspace.collection.href  # Assumes feed/workspace/collection structure

    # Check if the collectionHref was found
    if ($collectionHref) {
      Write-Host "Collection URL: $collectionHref"
      return $collectionHref
    } else {
      Write-Warning "No collection URL found in $($FilePath)."
      return $null
    }
  }
  catch {
    Write-Error "Error processing $($FilePath): $($_.Exception.Message)"
    return $null
  }
}

# Example usage:  Replace "C:\Path\To\Your\Service.atomsvc" with your file path.
$atomsvcFilePath = "C:\Path\To\Your\Service.atomsvc"
$collectionUrl = Process-AtomSvcFile -FilePath $atomsvcFilePath

if ($collectionUrl) {
  # Do something with the collection URL.  For example:
  # Invoke-WebRequest -Uri $collectionUrl
  Write-Host "Collection URL retrieved successfully."
}