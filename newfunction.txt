public void ParseDirectoryResult(SearchResult result)
{
    // Helper to safely get the byte array
    byte[] GetBytes(string propName)
    {
        if (result.Properties.Contains(propName) && result.Properties[propName].Count > 0)
        {
            return result.Properties[propName][0] as byte[];
        }
        return null;
    }

    // 1. Parsing objectGUID
    byte[] guidBytes = GetBytes("objectGUID");
    if (guidBytes != null)
    {
        Console.WriteLine("GUID: " + new Guid(guidBytes));
    }

    // 2. Parsing objectSid
    byte[] sidBytes = GetBytes("objectSid");
    if (sidBytes != null)
    {
        var sid = new SecurityIdentifier(sidBytes, 0);
        Console.WriteLine("SID: " + sid.ToString());
    }

    // 3. Parsing generic binary data (e.g. mS-DS-ConsistencyGuid or custom attributes)
    byte[] customBytes = GetBytes("mS-DS-ConsistencyGuid");
    if (customBytes != null)
    {
        string hex = BitConverter.ToString(customBytes);
        Console.WriteLine($"Hex Data: {hex}");
    }
}