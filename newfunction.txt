@page "/me"
@using Microsoft.Graph
@attribute [Microsoft.Identity.Web.UI.AuthorizeForScopes(Scopes = new[] {"User.Read"})]
@inject GraphServiceClient Graph

<h3>Me</h3>

@if (_me is null) { <p>Loadingâ€¦</p> }
else {
  <p>@_me.DisplayName (@_me.UserPrincipalName)</p>
}

@code {
  private User? _me;
  protected override async Task OnInitializedAsync() {
      _me = await Graph.Me.GetAsync(req => {
          req.QueryParameters.Select = new[] { "id","displayName","userPrincipalName","mail" };
      });
  }
}
