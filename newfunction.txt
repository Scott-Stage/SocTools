string managerDn = GetProp(result, "manager");
if (!string.IsNullOrEmpty(managerDn))
{
    // UPDATED REGEX:
    // This pattern captures characters that are EITHER:
    // 1. Not a comma ([^,])
    // 2. OR an escaped comma (\\,)
    var match = Regex.Match(managerDn, @"CN=((?:[^,]|\\,)+)");
    
    if (match.Success)
    {
        // match.Groups[1] will contain "Lastname\, Firstname"
        // We replace "\\" with empty string to make it "Lastname, Firstname"
        user.ManagerName = match.Groups[1].Value.Replace("\\", "");
    }

    // Lookup Manager ID (This remains the same)
    user.ManagerId = GetManagerIdFromDn(managerDn);
}