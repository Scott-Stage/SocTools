function Process-AtomSvcFile {
  param (
    [Parameter(Mandatory = $true, Position = 0)]
    [string]$FilePath
  )

  try {
    # Read the XML content from the file
    [xml]$xmlContent = Get-Content -Path $FilePath -Encoding UTF8

    # Define XML namespaces
    $namespace = New-Object System.Xml.XmlNamespaceManager($xmlContent.NameTable)
    $namespace.AddNamespace("app", "http://www.w3.org/2007/app")
    $namespace.AddNamespace("atom", "http://www.w3.org/2005/Atom")

    # Use XPath to select the workspace element
    $xpathWorkspace = "//app:workspace"
    $workspace = $xmlContent.SelectSingleNode($xpathWorkspace, $namespace)

    if ($workspace) {
        # Use XPath to select the collection element
        $xpathCollection = "./app:collection"
        $collection = $workspace.SelectSingleNode($xpathCollection, $namespace)

        if ($collection) {
            # Extract the href attribute
            $collectionHref = $collection.GetAttribute("href")

            if ($collectionHref) {
                Write-Host "Collection URL: $collectionHref"
                return $collectionHref
            } else {
                Write-Warning "No 'href' attribute found in the collection element of $($FilePath)."
                return $null
            }
        } else {
            Write-Warning "No collection element found in the workspace of $($FilePath)."
            return $null
        }
    } else {
        Write-Warning "No workspace element found in $($FilePath)."
        return $null
    }
  }
  catch {
    Write-Error "Error processing $($FilePath): $($_.Exception.Message)"
    return $null
  }
}

# Example usage:  Replace "C:\Path\To\Your\Service.atomsvc" with your file path.
$atomsvcFilePath = "C:\Path\To\Your\Service.atomsvc"
$collectionUrl = Process-AtomSvcFile -FilePath $atomsvcFilePath

if ($collectionUrl) {
  # Do something with the collection URL.  For example:
  # Invoke-WebRequest -Uri $collectionUrl
  Write-Host "Collection URL retrieved successfully."
}